var he=Symbol.for("immer-nothing"),L=Symbol.for("immer-draftable"),m=Symbol.for("immer-state");function S(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var v=Object,R=v.getPrototypeOf,B="constructor",b="prototype",fe="configurable",j="enumerable",Q="writable",K="value",C=e=>!!e&&!!e[m];function k(e){var t;return e?Ce(e)||H(e)||!!e[L]||!!((t=e[B])!=null&&t[L])||X(e)||q(e):!1}var Ie=v[b][B].toString(),Se=new WeakMap;function Ce(e){if(!e||!N(e))return!1;const t=R(e);if(t===null||t===v[b])return!0;const r=v.hasOwnProperty.call(t,B)&&t[B];if(r===Object)return!0;if(!E(r))return!1;let n=Se.get(r);return n===void 0&&(n=Function.toString.call(r),Se.set(r,n)),n===Ie}function Xe(e){return C(e)||S(15,e),e[m].base_}function U(e,t,r=!0){I(e)===0?(r?Reflect.ownKeys(e):v.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function I(e){const t=e[m];return t?t.type_:H(e)?1:X(e)?2:q(e)?3:0}var W=(e,t,r=I(e))=>r===2?e.has(t):v[b].hasOwnProperty.call(e,t),O=(e,t,r=I(e))=>r===2?e.get(t):e[t],ee=(e,t,r,n=I(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function Me(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var H=Array.isArray,X=e=>e instanceof Map,q=e=>e instanceof Set,N=e=>typeof e=="object",E=e=>typeof e=="function",ce=e=>typeof e=="boolean",Te=e=>N(e)?e==null?void 0:e[m]:null,A=e=>e.copy_||e.base_,pe=e=>e.modified_?e.copy_:e.base_;function ue(e,t){if(X(e))return new Map(e);if(q(e))return new Set(e);if(H(e))return Array[b].slice.call(e);const r=Ce(e);if(t===!0||t==="class_only"&&!r){const n=v.getOwnPropertyDescriptors(e);delete n[m];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){const h=i[o],l=n[h];l[Q]===!1&&(l[Q]=!0,l[fe]=!0),(l.get||l.set)&&(n[h]={[fe]:!0,[Q]:!0,[j]:l[j],[K]:e[h]})}return v.create(R(e),n)}else{const n=R(e);if(n!==null&&r)return{...e};const i=v.create(n);return v.assign(i,e)}}function ye(e,t=!1){return ie(e)||C(e)||!k(e)||(I(e)>1&&v.defineProperties(e,{set:J,add:J,clear:J,delete:J}),v.freeze(e),t&&U(e,(r,n)=>{ye(n,!0)},!1)),e}function Ne(){S(2)}var J={[K]:Ne};function ie(e){return e===null||!N(e)?!0:v.isFrozen(e)}var te="MapSet",re="Patches",ne={};function x(e){const t=ne[e];return t||S(0,e),t}var xe=e=>!!ne[e];function Ue(e,t){ne[e]||(ne[e]=t)}var G,ke=()=>G,Ve=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:xe(te)?x(te):void 0});function ve(e,t){t&&(e.patchPlugin_=x(re),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ae(e){le(e),e.drafts_.forEach(Le),e.drafts_=null}function le(e){e===G&&(G=e.parent_)}var ge=e=>G=Ve(G,e);function Le(e){const t=e[m];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function we(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[m].modified_&&(ae(t),S(4)),k(e)&&(e=ze(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[m].base_,e,t)}else e=ze(t,r);return We(t,e,!0),ae(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==he?e:void 0}function ze(e,t){if(ie(t))return t;const r=t[m];if(!r)return Pe(t,e.handledSet_,e);if(!oe(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);Ae(r,e)}return r.copy_}function We(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ye(t,r)}function Fe(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var oe=(e,t)=>e.scope_===t,Be=[];function Oe(e,t,r,n){const i=A(e),o=e.type_;if(n!==void 0&&O(i,n,o)===t){ee(i,n,r,o);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;U(i,(g,w)=>{if(C(w)){const F=l.get(w)||[];F.push(g),l.set(w,F)}})}const h=e.draftLocations_.get(t)??Be;for(const l of h)ee(i,l,r,o)}function Ke(e,t,r){e.callbacks_.push(function(i){var l;const o=t;if(!o||!oe(o,i))return;(l=i.mapSetPlugin_)==null||l.fixSetContents(o);const h=pe(o);Oe(e,o.draft_??o,h,r),Ae(o,i)})}function Ae(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const o=i.getPath(e);o&&i.generatePatches_(e,o,t)}Fe(e)}}function Ge(e,t,r){const{scope_:n}=e;if(C(r)){const i=r[m];oe(i,n)&&i.callbacks_.push(function(){Z(e);const h=pe(i);Oe(e,r,h,t)})}else k(r)&&e.callbacks_.push(function(){const o=A(e);O(o,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&Pe(O(e.copy_,t,e.type_),n.handledSet_,n)})}function Pe(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||C(e)||t.has(e)||!k(e)||ie(e)||(t.add(e),U(e,(n,i)=>{if(C(i)){const o=i[m];if(oe(o,r)){const h=pe(o);ee(e,n,h,e.type_),Fe(o)}}else k(i)&&Pe(i,t,r)})),e}function Ye(e,t){const r=H(e),n={type_:r?1:0,scope_:t?t.scope_:ke(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,o=me;r&&(i=[n],o=Y);const{revoke:h,proxy:l}=Proxy.revocable(i,o);return n.draft_=l,n.revoke_=h,[l,n]}var me={get(e,t){if(t===m)return e;const r=A(e);if(!W(r,t,e.type_))return $e(e,r,t);const n=r[t];if(e.finalized_||!k(n))return n;if(n===se(e.base_,t)){Z(e);const i=e.type_===1?+t:t,o=de(e.scope_,n,e,i);return e.copy_[i]=o}return n},has(e,t){return t in A(e)},ownKeys(e){return Reflect.ownKeys(A(e))},set(e,t,r){const n=De(A(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=se(A(e),t),o=i==null?void 0:i[m];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(Me(r,i)&&(r!==void 0||W(e.base_,t,e.type_)))return!0;Z(e),_e(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),Ge(e,t,r)),!0},deleteProperty(e,t){return Z(e),se(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),_e(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=A(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Q]:!0,[fe]:e.type_!==1||t!=="length",[j]:n[j],[K]:r[t]}},defineProperty(){S(11)},getPrototypeOf(e){return R(e.base_)},setPrototypeOf(){S(12)}},Y={};U(me,(e,t)=>{Y[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}});Y.deleteProperty=function(e,t){return Y.set.call(this,e,t,void 0)};Y.set=function(e,t,r){return me.set.call(this,e[0],t,r,e[0])};function se(e,t){const r=e[m];return(r?A(r):e)[t]}function $e(e,t,r){var i;const n=De(t,r);return n?K in n?n[K]:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function De(e,t){if(!(t in e))return;let r=R(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=R(r)}}function _e(e){e.modified_||(e.modified_=!0,e.parent_&&_e(e.parent_))}function Z(e){e.copy_||(e.assigned_=new Map,e.copy_=ue(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var be=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(t,r,n)=>{if(E(t)&&!E(r)){const o=r;r=t;const h=this;return function(g=o,...w){return h.produce(g,F=>r.call(this,F,...w))}}E(r)||S(6),n!==void 0&&!E(n)&&S(7);let i;if(k(t)){const o=ge(this),h=de(o,t,void 0);let l=!0;try{i=r(h),l=!1}finally{l?ae(o):le(o)}return ve(o,n),we(i,o)}else if(!t||!N(t)){if(i=r(t),i===void 0&&(i=t),i===he&&(i=void 0),this.autoFreeze_&&ye(i,!0),n){const o=[],h=[];x(re).generateReplacementPatches_(t,i,{patches_:o,inversePatches_:h}),n(o,h)}return i}else S(1,t)},this.produceWithPatches=(t,r)=>{if(E(t))return(h,...l)=>this.produceWithPatches(h,g=>t(g,...l));let n,i;return[this.produce(t,r,(h,l)=>{n=h,i=l}),n,i]},ce(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),ce(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),ce(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){k(e)||S(8),C(e)&&(e=He(e));const t=ge(this),r=de(t,e,void 0);return r[m].isManual_=!0,le(t),r}finishDraft(e,t){const r=e&&e[m];(!r||!r.isManual_)&&S(9);const{scope_:n}=r;return ve(n,t),we(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=x(re).applyPatches_;return C(e)?n(e,t):this.produce(e,i=>n(i,t))}};function de(e,t,r,n){const[i,o]=X(t)?x(te).proxyMap_(t,r):q(t)?x(te).proxySet_(t,r):Ye(t,r);return((r==null?void 0:r.scope_)??ke()).drafts_.push(i),o.callbacks_=(r==null?void 0:r.callbacks_)??[],o.key_=n,r&&n!==void 0?Ke(r,o,n):o.callbacks_.push(function(g){var F;(F=g.mapSetPlugin_)==null||F.fixSetContents(o);const{patchPlugin_:w}=g;o.modified_&&w&&w.generatePatches_(o,[],g)}),i}function He(e){return C(e)||S(10,e),Ee(e)}function Ee(e){if(!k(e)||ie(e))return e;const t=e[m];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ue(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=ue(e,!0);return U(r,(i,o)=>{ee(r,i,Ee(o))},n),t&&(t.finalized_=!1),r}function qe(){function t(c,u=[]){if("key_"in c&&c.key_!==void 0){const f=c.parent_.copy_??c.parent_.base_,a=Te(O(f,c.key_)),_=O(f,c.key_);if(_===void 0||_!==c.draft_&&_!==c.base_&&_!==c.copy_||a!=null&&a.base_!==c.base_)return null;const d=c.parent_.type_===3;let y;if(d){const s=c.parent_;y=Array.from(s.drafts_.keys()).indexOf(c.key_)}else y=c.key_;if(!(d&&f.size>y||W(f,y)))return null;u.push(y)}if(c.parent_)return t(c.parent_,u);u.reverse();try{r(c.copy_,u)}catch{return null}return u}function r(c,u){let f=c;for(let a=0;a<u.length-1;a++){const _=u[a];if(f=O(f,_),!N(f)||f===null)throw new Error(`Cannot resolve path at '${u.join("/")}'`)}return f}const n="replace",i="add",o="remove";function h(c,u,f){if(c.scope_.processedForPatches_.has(c))return;c.scope_.processedForPatches_.add(c);const{patches_:a,inversePatches_:_}=f;switch(c.type_){case 0:case 2:return g(c,u,a,_);case 1:return l(c,u,a,_);case 3:return w(c,u,a,_)}}function l(c,u,f,a){let{base_:_,assigned_:d}=c,y=c.copy_;y.length<_.length&&([_,y]=[y,_],[f,a]=[a,f]);for(let s=0;s<_.length;s++){const p=y[s],z=_[s];if(d!=null&&d.get(s.toString())&&p!==z){const D=p==null?void 0:p[m];if(D&&D.modified_)continue;const P=u.concat([s]);f.push({op:n,path:P,value:T(p)}),a.push({op:n,path:P,value:T(z)})}}for(let s=_.length;s<y.length;s++){const p=u.concat([s]);f.push({op:i,path:p,value:T(y[s])})}for(let s=y.length-1;_.length<=s;--s){const p=u.concat([s]);a.push({op:o,path:p})}}function g(c,u,f,a){const{base_:_,copy_:d,type_:y}=c;U(c.assigned_,(s,p)=>{const z=O(_,s,y),D=O(d,s,y),P=p?W(_,s)?n:i:o;if(z===D&&P===n)return;const V=u.concat(s);f.push(P===o?{op:P,path:V}:{op:P,path:V,value:T(D)}),a.push(P===i?{op:o,path:V}:P===o?{op:i,path:V,value:T(z)}:{op:n,path:V,value:T(z)})})}function w(c,u,f,a){let{base_:_,copy_:d}=c,y=0;_.forEach(s=>{if(!d.has(s)){const p=u.concat([y]);f.push({op:o,path:p,value:s}),a.unshift({op:i,path:p,value:s})}y++}),y=0,d.forEach(s=>{if(!_.has(s)){const p=u.concat([y]);f.push({op:i,path:p,value:s}),a.unshift({op:o,path:p,value:s})}y++})}function F(c,u,f){const{patches_:a,inversePatches_:_}=f;a.push({op:n,path:[],value:u===he?void 0:u}),_.push({op:n,path:[],value:c})}function Re(c,u){return u.forEach(f=>{const{path:a,op:_}=f;let d=c;for(let z=0;z<a.length-1;z++){const D=I(d);let P=a[z];typeof P!="string"&&typeof P!="number"&&(P=""+P),(D===0||D===1)&&(P==="__proto__"||P===B)&&S(19),E(d)&&P===b&&S(19),d=O(d,P),N(d)||S(18,a.join("/"))}const y=I(d),s=M(f.value),p=a[a.length-1];switch(_){case n:switch(y){case 2:return d.set(p,s);case 3:S(16);default:return d[p]=s}case i:switch(y){case 1:return p==="-"?d.push(s):d.splice(p,0,s);case 2:return d.set(p,s);case 3:return d.add(s);default:return d[p]=s}case o:switch(y){case 1:return d.splice(p,1);case 2:return d.delete(p);case 3:return d.delete(f.value);default:return delete d[p]}default:S(17,_)}}),c}function M(c){if(!k(c))return c;if(H(c))return c.map(M);if(X(c))return new Map(Array.from(c.entries()).map(([f,a])=>[f,M(a)]));if(q(c))return new Set(Array.from(c).map(M));const u=Object.create(R(c));for(const f in c)u[f]=M(c[f]);return W(c,L)&&(u[L]=c[L]),u}function T(c){return C(c)?M(c):c}Ue(re,{applyPatches_:Re,generatePatches_:h,generateReplacementPatches_:F,getPath:t})}var $=new be,Je=$.produce,Qe=$.produceWithPatches.bind($),Ze=$.applyPatches.bind($);export{C as a,Ze as b,Qe as c,He as d,qe as e,k as i,Xe as o,Je as p};
